{"version":3,"sources":["SpotifyContext.tsx","SplashScreen.tsx","Setup.tsx","Songs.tsx","Success.tsx","AuthenticatedRoute.tsx","SpotifyProvider.tsx","App.tsx","reportWebVitals.js","index.js"],"names":["_default","expiresAt","isAuth","api","userID","React","Splash","useContext","SpotifyContext","className","to","useStyles","makeStyles","root","padding","buttons","button","marginLeft","marginRight","link","textDecoration","emptyFunction","Setup","useState","bpmRange","setBpmRange","classes","getSongsURI","useCallback","useUserArtists","pathname","search","Box","display","flexDirection","Slider","value","onChange","_","newBpm","valueLabelDisplay","aria-labelledby","step","min","max","justifyContent","Button","variant","color","onClick","style","table","minWidth","Songs","selectedTrackInfo","setSelectedTrackInfo","playlistName","setPlaylistName","history","useHistory","params","URLSearchParams","window","location","minBpm","get","maxBpm","tracks","setTracks","tracksRef","useRef","loadMore","getMySavedTracks","limit","offset","current","length","then","data","items","map","i","track","loadMoreRef","useEffect","useUserSongs","filteredTracks","setFilteredTracks","filterTracks","ids","id","getAudioFeaturesForTracks","filteredIds","audio_features","filter","feature","tempo","t","includes","useFilterTracksByBPM","isCreateButtonDisabled","trim","TextField","label","event","target","createPlaylist","name","public","description","selectedTrackURIs","info","uri","addTracksToPlaylist","push","disabled","TableContainer","Table","size","TableHead","TableRow","TableCell","Checkbox","indeterminate","checked","TableBody","isSelected","hover","role","selectedIndex","indexOf","newSelected","concat","slice","handleClick","artists","a","join","album","Success","playlistData","setPlaylistData","getPlaylist","external_urls","images","usePlaylistDetails","useParams","playlistid","href","spotify","SCOPES","AuthenticatedRoute","props","encodeURI","process","usePrevious","ref","SpotifyWebApi","SpotifyProvider","children","setUserID","hashParams","hash","substr","accessTokenFromAuth","expiresInFromAuth","accessToken","setAccessToken","setExpiresAt","initAPI","token","getMe","prevAccessTokenFromAuth","prevExpiresInFromAuth","Date","getTime","providerValue","useMemo","Provider","App","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","require","config","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.61d9ad8c.chunk.js","sourcesContent":["import * as React from \"react\";\n\ninterface SpotifyContext {\n  expiresAt: number | null; // epoch time this expires at\n  isAuth: boolean;\n  api: any; // TODO figure out how tf to do this with typescript\n  userID: string | null;\n}\n\nconst _default: SpotifyContext = {\n  expiresAt: null,\n  isAuth: false,\n  api: null,\n  userID: null,\n};\n\nexport default React.createContext(_default);\n","import * as React from \"react\";\nimport \"./Splash.css\";\nimport SpotifyContext from \"./SpotifyContext\";\n\nimport { Link } from \"react-router-dom\";\nimport { useContext } from \"react\";\n\nexport default function Splash() {\n  const { isAuth } = useContext(SpotifyContext);\n\n  return (\n    <div>\n      <header className=\"Splash-header\">\n        <Link to=\"/spotibike/setup\">{isAuth ? \"Continue\" : \"Login\"}</Link>\n      </header>\n    </div>\n  );\n}\n","import * as React from \"react\";\nimport { useCallback, useContext, useState } from \"react\";\n\nimport SpotifyContext from \"./SpotifyContext\";\n\nimport { Button, Box, Slider, makeStyles } from \"@material-ui/core\";\nimport { Link } from \"react-router-dom\";\n\nconst MIN_BPM = 30;\nconst MAX_BPM = 150;\n\nconst useStyles = makeStyles({\n  root: {\n    padding: 32,\n  },\n  buttons: {\n    padding: 64,\n  },\n  button: {\n    marginLeft: 12,\n    marginRight: 12,\n  },\n  link: {\n    textDecoration: \"none\",\n  },\n});\n\nconst emptyFunction = () => {};\nexport default function Setup() {\n  const [bpmRange, setBpmRange] = useState([60, 120]);\n\n  const { isAuth } = useContext(SpotifyContext);\n\n  const handleChange = (_: any, newBpm: any /* TODO: stricter typing */) => {\n    setBpmRange(newBpm);\n  };\n\n  const classes = useStyles();\n  const getSongsURI = useCallback(\n    (useUserArtists: boolean) => {\n      return {\n        pathname: \"/spotibike/songs\",\n        search: `?use_user_artists=${useUserArtists}&min_bpm=${bpmRange[0]}&max_bpm=${bpmRange[1]}`,\n      };\n    },\n    [bpmRange]\n  );\n\n  if (!isAuth) return <></>;\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" className={classes.root}>\n      <div>Recommended BPM: ~90</div>\n      <div>\n        Selected BPM: {bpmRange[0]} - {bpmRange[1]}\n      </div>\n      <Slider\n        value={bpmRange}\n        onChange={handleChange}\n        valueLabelDisplay=\"on\"\n        aria-labelledby=\"range-slider\"\n        step={1}\n        min={MIN_BPM}\n        max={MAX_BPM}\n      />\n      <Box\n        display=\"flex\"\n        flexDirection=\"row\"\n        className={classes.buttons}\n        justifyContent=\"space-around\"\n      >\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={emptyFunction}\n          className={classes.button}\n        >\n          {/* TODO proper styling */}\n          <Link\n            to={getSongsURI(true)}\n            style={{ textDecoration: \"none\", color: \"white\" }}\n          >\n            Make Playlist from Your Artists/Albums\n          </Link>\n        </Button>\n        {/* <Button\n          variant=\"contained\"\n          onClick={emptyFunction}\n          className={classes.button}\n        >\n          <Link\n            to={getSongsURI(false)}\n            style={{ textDecoration: \"none\", color: \"black\" }}\n          >\n            Make Playlist from Random Top Music\n          </Link>\n        </Button> */}\n      </Box>\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport { useCallback, useContext, useEffect, useRef, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\n\nimport SpotifyContext from \"./SpotifyContext\";\n\nimport {\n  Box,\n  Button,\n  Checkbox,\n  makeStyles,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableHead,\n  TableRow,\n  TextField,\n} from \"@material-ui/core\";\n\nconst useStyles = makeStyles({\n  root: {\n    padding: 32,\n  },\n  table: {\n    minWidth: 750,\n  },\n  button: {\n    marginLeft: 12,\n    marginRight: 12,\n  },\n});\n\nfunction useUserSongs() {\n  const [tracks, setTracks] = useState([]);\n  const tracksRef = useRef(tracks);\n\n  const { api } = useContext(SpotifyContext);\n\n  // todo: use offset for load more\n  const loadMore = useCallback(() => {\n    api\n      .getMySavedTracks({ limit: 50, offset: tracksRef.current.length ?? 0 })\n      .then((data: any) => {\n        setTracks(\n          data.items.map((i: { added_at: string; track: any }) => i.track)\n        );\n      });\n  }, [api]);\n  const loadMoreRef = useRef(loadMore);\n\n  useEffect(() => {\n    if (tracks.length === 0) {\n      loadMoreRef.current();\n    }\n  }, [tracks]);\n\n  return [tracks, loadMoreRef.current];\n}\n\nfunction useFilterTracksByBPM(tracks: any, minBpm: number, maxBpm: number) {\n  const [filteredTracks, setFilteredTracks] = useState([]);\n  const { api } = useContext(SpotifyContext);\n\n  const filterTracks = useCallback(() => {\n    const ids = tracks.map(({ id }: { id: string }) => id);\n    // TODO: handle case of more than limit (50) ids\n    api\n      .getAudioFeaturesForTracks(ids)\n      .then(({ audio_features: features }: { audio_features: any }) => {\n        const filteredIds = features\n          .filter((feature: { tempo: number }) => {\n            if (feature == null) {\n              return false;\n            }\n            const { tempo } = feature;\n            return tempo >= minBpm && tempo <= maxBpm;\n          })\n          .map((feature: any) => feature.id);\n        const filteredTracks = tracks.filter((t: any) =>\n          filteredIds.includes(t.id)\n        );\n        setFilteredTracks(filteredTracks);\n      });\n  }, [api, tracks, minBpm, maxBpm]);\n\n  useEffect(() => {\n    // filter whenever tracks length changes\n    filterTracks();\n  }, [tracks.length]);\n\n  return filteredTracks;\n}\n\ntype TrackInfo = {\n  id: string;\n  uri: string;\n};\n\nexport default function Songs() {\n  const [selectedTrackInfo, setSelectedTrackInfo] = useState<TrackInfo[]>([]);\n  const [playlistName, setPlaylistName] = useState<string>(\"\");\n  const { isAuth, api, userID } = useContext(SpotifyContext);\n  const classes = useStyles();\n  const history = useHistory();\n\n  const params = new URLSearchParams(window.location.search);\n\n  const useUserArtists = params.get(\"use_user_artists\") === \"true\";\n  const minBpm = +(params.get(\"min_bpm\") ?? \"0\");\n  const maxBpm = +(params.get(\"max_bpm\") ?? \"0\");\n\n  const [tracks] = useUserSongs();\n  const filteredTracks: TrackInfo[] = useFilterTracksByBPM(\n    tracks,\n    minBpm,\n    maxBpm\n  );\n\n  if (!isAuth) return <></>;\n\n  const handleClick = (id: string, uri: string) => {\n    const selectedIndex = selectedTrackInfo.map((info) => info.id).indexOf(id);\n    let newSelected: TrackInfo[] = [];\n\n    if (selectedIndex === -1) {\n      newSelected = newSelected.concat(selectedTrackInfo, { id, uri });\n    } else if (selectedIndex === 0) {\n      newSelected = newSelected.concat(selectedTrackInfo.slice(1));\n    } else if (selectedIndex === selectedTrackInfo.length - 1) {\n      newSelected = newSelected.concat(selectedTrackInfo.slice(0, -1));\n    } else if (selectedIndex > 0) {\n      newSelected = selectedTrackInfo.concat(\n        selectedTrackInfo.slice(0, selectedIndex),\n        selectedTrackInfo.slice(selectedIndex + 1)\n      );\n    }\n\n    setSelectedTrackInfo(newSelected);\n  };\n\n  const handleSelectAllClicked = () => {\n    if (selectedTrackInfo.length === 0) {\n      const selectedTrackInfo = filteredTracks.map(\n        ({ id, uri }: { id: string; uri: string }) => ({\n          id,\n          uri,\n        })\n      );\n      setSelectedTrackInfo(selectedTrackInfo);\n    } else {\n      setSelectedTrackInfo([]);\n    }\n  };\n\n  const isCreateButtonDisabled =\n    playlistName.trim() === \"\" || selectedTrackInfo.length < 1;\n  const createPlaylist = () => {\n    if (isCreateButtonDisabled) {\n      return;\n    }\n    api\n      .createPlaylist(userID, {\n        name: playlistName,\n        public: false, // make playlist private by default\n        description: `${minBpm} to ${maxBpm} BPM playlist - Made with Spotibike`,\n      })\n      .then((data: { id: string }) => {\n        const selectedTrackURIs = selectedTrackInfo.map((info) => info.uri);\n        // TODO: handle > 100 items to add to playlist\n        api.addTracksToPlaylist(data.id, selectedTrackURIs).then(() => {\n          history.push(`/spotibike/success/${data.id}`);\n        });\n      });\n  };\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" className={classes.root}>\n      <div>\n        <div>Song Select</div>\n        <div>\n          Enter Playlist Name:{\" \"}\n          <TextField\n            label=\"Playlist Name\"\n            variant=\"filled\"\n            value={playlistName}\n            onChange={(event: any) => setPlaylistName(event.target.value)}\n          />\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={createPlaylist}\n            className={classes.button}\n            disabled={isCreateButtonDisabled}\n          >\n            Create Playlist\n          </Button>\n        </div>\n      </div>\n      <TableContainer>\n        <Table className={classes.table} size={\"medium\"}>\n          <TableHead>\n            <TableRow>\n              <TableCell padding=\"checkbox\">\n                <Checkbox\n                  onChange={handleSelectAllClicked}\n                  indeterminate={\n                    selectedTrackInfo.length > 0 &&\n                    selectedTrackInfo.length < filteredTracks.length\n                  }\n                  checked={selectedTrackInfo.length > 0}\n                />\n              </TableCell>\n              <TableCell>Track Name</TableCell>\n              <TableCell>Artist(s)</TableCell>\n              <TableCell>Album</TableCell>\n            </TableRow>\n          </TableHead>\n          <TableBody>\n            {filteredTracks.map((track: any) => {\n              const isSelected = selectedTrackInfo\n                .map((info: { id: string }) => info.id)\n                .includes(track.id);\n              return (\n                <TableRow\n                  hover\n                  role=\"checkbox\"\n                  key={track.id}\n                  onClick={() => handleClick(track.id, track.uri)}\n                >\n                  <TableCell padding=\"checkbox\">\n                    <Checkbox checked={isSelected} />\n                  </TableCell>\n                  <TableCell>{track.name}</TableCell>\n                  <TableCell>\n                    {track.artists.map((a: any) => a.name).join(\", \")}\n                  </TableCell>\n                  <TableCell>{track.album.name}</TableCell>\n                </TableRow>\n              );\n            })}\n          </TableBody>\n        </Table>\n      </TableContainer>\n    </Box>\n  );\n}\n","import * as React from \"react\";\nimport SpotifyContext from \"./SpotifyContext\";\n\nimport { useContext, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\n\ntype PlaylistData = {\n  external_urls: {\n    spotify: string;\n  };\n  images: string[];\n};\n\nfunction usePlaylistDetails(id: string) {\n  const { api } = useContext(SpotifyContext);\n  const [playlistData, setPlaylistData] = useState<null | PlaylistData>(null);\n\n  api.getPlaylist(id).then(({ external_urls, images }: PlaylistData) => {\n    setPlaylistData({ external_urls, images });\n  });\n\n  return playlistData;\n}\n\nexport default function Success() {\n  const { isAuth } = useContext(SpotifyContext);\n  const { playlistid: playlistID } = useParams<{ playlistid: string }>();\n  const playlistData = usePlaylistDetails(playlistID);\n\n  if (!isAuth) {\n    return <></>;\n  }\n\n  return (\n    <div>\n      Playlist Created:{\" \"}\n      <a href={playlistData?.external_urls.spotify}>\n        {playlistData?.external_urls.spotify ?? \"Loading Details...\"}\n      </a>\n    </div>\n  );\n}\n","import * as React from \"react\";\n\nimport { Route } from \"react-router-dom\";\nimport SpotifyContext from \"./SpotifyContext\";\nimport { useContext } from \"react\";\n\nconst HOSTED_APP_URI = \"https://rageandqq.github.io/spotibike/\";\nconst HOSTED_APP_DEV_URI = \"http://localhost:3000/spotibike/\";\n\nconst SPOTIFY_AUTH_URI = \"https://accounts.spotify.com/authorize\";\nconst CLIENT_ID = \"6fd3ee11d3a146ffad18854c9762964c\";\n\nconst isDev = process.env.NODE_ENV === \"development\";\nconst REDIRECT_URI = isDev ? HOSTED_APP_DEV_URI : HOSTED_APP_URI;\n\nconst SCOPES = [\n  \"playlist-read-private\",\n  \"playlist-modify-private\",\n  \"user-library-read\",\n];\n\nconst ALWAYS_AUTHENTICATE = isDev;\n\nconst getRedirectURI = () =>\n  encodeURI(\n    `${SPOTIFY_AUTH_URI}?client_id=${CLIENT_ID}&response_type=token&redirect_uri=${REDIRECT_URI}&scope=${SCOPES.join(\n      \" \"\n    )}&show_dialog=${ALWAYS_AUTHENTICATE}`\n  );\n\ninterface IProps {\n  children: React.ReactNode;\n  path: string;\n}\nexport default function AuthenticatedRoute(props: IProps) {\n  const { isAuth } = useContext(SpotifyContext);\n\n  if (!isAuth) {\n    window.location.href = getRedirectURI();\n  }\n\n  return <Route {...props} />;\n}\n","import * as React from \"react\";\nimport SpotifyContext from \"./SpotifyContext\";\n\nimport { useState, useMemo, useEffect, useCallback, useRef } from \"react\";\nimport SpotifyWebApi from \"spotify-web-api-js\";\n\ntype IProps = {\n  children: React.ReactNode;\n};\n\nfunction usePrevious<T>(value: T) {\n  // The ref object is a generic container whose current property is mutable ...\n  // ... and can hold any value, similar to an instance property on a class\n  const ref = useRef<T>();\n\n  // Store current value in ref\n  useEffect(() => {\n    ref.current = value;\n  }, [value]); // Only re-run if value changes\n\n  // Return previous value (happens before update in useEffect above)\n  return ref.current;\n}\n\nconst api = new SpotifyWebApi();\n\nexport default function SpotifyProvider({ children }: IProps) {\n  const [userID, setUserID] = useState<null | string>(null);\n  const hashParams = new URLSearchParams(\n    window.location.hash.substr(1) // skip the first char (#)\n  );\n\n  const accessTokenFromAuth = hashParams.get(\"access_token\");\n  const expiresInFromAuth = hashParams.get(\"exipres_in\");\n\n  const [accessToken, setAccessToken] = useState<string | null>(\n    accessTokenFromAuth\n  );\n  const [expiresAt, setExpiresAt] = useState<number | null>(\n    expiresInFromAuth != null ? +expiresInFromAuth : null // not a typo, use \"+\" to convert to number\n  );\n\n  const initAPI = useCallback((token) => {\n    api.setAccessToken(token);\n    api.getMe().then((data) => {\n      setUserID(data.id);\n    });\n  }, []);\n\n  // This is probbaly unnecessary... but if it changes, we should do something\n  const prevAccessTokenFromAuth = usePrevious<string | null>(\n    accessTokenFromAuth\n  );\n  const prevExpiresInFromAuth = usePrevious<string | null>(expiresInFromAuth);\n  useEffect(() => {\n    if (\n      accessTokenFromAuth != null &&\n      prevAccessTokenFromAuth !== accessTokenFromAuth\n    ) {\n      setAccessToken(accessTokenFromAuth);\n      initAPI(accessTokenFromAuth);\n    }\n    if (\n      expiresInFromAuth != null &&\n      prevExpiresInFromAuth !== expiresInFromAuth\n    ) {\n      setExpiresAt(new Date().getTime() + +expiresInFromAuth); // not a typo, use \"+\" to convert to number\n    }\n  }, [\n    prevAccessTokenFromAuth,\n    accessTokenFromAuth,\n    prevExpiresInFromAuth,\n    expiresInFromAuth,\n    initAPI,\n  ]);\n\n  const providerValue = useMemo(\n    () => ({\n      // accessToken,\n      expiresAt,\n      isAuth: accessToken != null, // TODO: figure out how to use expiresAt\n      api,\n      userID,\n    }),\n    [accessToken, expiresAt, userID]\n  );\n\n  return (\n    <SpotifyContext.Provider value={providerValue}>\n      {children}\n    </SpotifyContext.Provider>\n  );\n}\n","import Splash from \"./SplashScreen\";\nimport Setup from \"./Setup\";\nimport Songs from \"./Songs\";\nimport Success from \"./Success\";\nimport AuthenticatedRoute from \"./AuthenticatedRoute\";\n\nimport * as React from \"react\";\n\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport SpotifyProvider from \"./SpotifyProvider\";\n\nfunction App() {\n  return (\n    <Router>\n      <SpotifyProvider>\n        <Switch>\n          <AuthenticatedRoute path=\"/spotibike/success/:playlistid\">\n            <Success />\n          </AuthenticatedRoute>\n          <AuthenticatedRoute path=\"/spotibike/songs\">\n            <Songs />\n          </AuthenticatedRoute>\n          <AuthenticatedRoute path=\"/spotibike/setup\">\n            <Setup />\n          </AuthenticatedRoute>\n          <Route path=\"/spotibike/\">\n            <Splash />\n          </Route>\n        </Switch>\n      </SpotifyProvider>\n    </Router>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nrequire(\"dotenv\").config();\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}